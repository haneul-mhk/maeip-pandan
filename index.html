<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»•å…¥ã‚Œåˆ¤æ–­</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #ffe4e1;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff0f5;
            border-radius: 8px;
            border: 1px solid #ffc0cb;
        }
        h1 {
            text-align: center;
            color: #db7093;
        }
        table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid #ffc0cb;
        }
        th, td {
            padding: 8px;
            text-align: left;
            background-color: #fffaf0;
            color: #db7093;
        }
        .buttons {
            text-align: center;
            margin-top: 20px;
        }
        .buttons button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            background-color: #db7093;
            color: white;
            border-radius: 4px;
            cursor: pointer;
        }
        .buttons button:hover {
            background-color: #ff69b4;
        }
        input[type="number"], select {
            width: 100%;
            padding: 8px;
            margin-top: 10px;
            border: 1px solid #ffc0cb;
            border-radius: 4px;
            background-color: #fffaf0;
            color: #db7093;
        }
        .highlight {
            font-weight: bold;
            color: #b22222;
        }
        .result-text {
            margin-top: 20px;
            padding: 10px;
            background-color: #fffaf0;
            border: 1px solid #ffc0cb;
            border-radius: 4px;
            color: #db7093;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ä»•å…¥ã‚Œåˆ¤æ–­</h1>
        <form id="profitCalculator">
            <label for="sellingPrice">ãƒ¡ãƒ«ã‚«ãƒªè²©å£²ä¾¡æ ¼ï¼ˆå††ï¼‰:</label>
            <input type="number" id="sellingPrice" placeholder="0" required>

            <br><br>

            <label for="commissionRate">ãƒ¡ãƒ«ã‚«ãƒªæ‰‹æ•°æ–™ç‡ (%):</label>
            <input type="number" id="commissionRate" value="10" placeholder="10" required>

            <br><br>

            <label for="shippingCost">ãƒ¡ãƒ«ã‚«ãƒªé€æ–™ï¼ˆå††ï¼‰:</label>
            <select id="shippingCost" required>
                <option value="160">ğŸ“®Â¥160 ã‚†ã†ãƒ‘ã‚±ãƒƒãƒˆãƒã‚¹ãƒˆminiï¼ˆè¦å°‚ç”¨å°ç­’ï¼‰</option>
                <option value="215">ğŸ“®Â¥215 ã‚†ã†ãƒ‘ã‚±ãƒƒãƒˆãƒã‚¹ãƒˆï¼ˆè¦å°‚ç”¨ã‚·ãƒ¼ãƒ«/è¦å°‚ç”¨ç®±ï¼‰</option>
                <option value="455">ğŸ£Â¥455 ã‚†ã†ãƒ‘ã‚±ãƒƒãƒˆãƒ—ãƒ©ã‚¹ï¼ˆè¦å°‚ç”¨ç®±ï¼‰</option>
                <option value="210">ğŸˆâ€â¬›Â¥210 ãƒã‚³ãƒã‚¹ï¼ˆãƒã‚¹ãƒˆå—å–ã‚µã‚¤ã‚ºï¼‰</option>
                <option value="450">ğŸˆâ€â¬›Â¥450 å®…æ€¥ä¾¿ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆ</option>
                <option value="None">æ‰‹å…¥åŠ›ã™ã‚‹</option>
            </select>

            <input type="number" id="shippingCostHand" placeholder="0" style="display: none;" required>

            <br><br>

            <label>ä»•å…¥ã‚Œå€¤:</label>
            <div>
                <input type="radio" id="costPriceJPY" name="costPriceCurrency" value="JPY" checked>
                <label for="costPriceJPY">å††</label>
                <input type="radio" id="costPriceKRW" name="costPriceCurrency" value="KRW">
                <label for="costPriceKRW">ã‚¦ã‚©ãƒ³</label>
            </div>

            <input type="number" id="costPrice" placeholder="0" required>

            <br><br>

            <label>ä»•å…¥ã‚Œæ™‚é€æ–™:</label>
            <div>
                <input type="radio" id="shippingCostJPY" name="shippingCostCurrency" value="JPY" checked>
                <label for="shippingCostJPY">å††</label>
                <input type="radio" id="shippingCostKRW" name="shippingCostCurrency" value="KRW">
                <label for="shippingCostKRW">ã‚¦ã‚©ãƒ³</label>
            </div>

            <input type="number" id="purchaseShippingCost" placeholder="0" required>

            <br><br>

            <label>é–¢ç¨:</label>
            <div>
                <input type="radio" id="customsDutyTrue" name="customsDuty" value="True" checked>
                <label for="customsDutyTrue">ã‚ã‚Š</label>
                <input type="radio" id="customsDutyFalse" name="customsDuty" value="False">
                <label for="customsDutyFalse">ãªã—</label>
            </div>

            <div class="buttons">
                <button type="button" onclick="calculateProfit()">è¨ˆç®—ã™ã‚‹</button>
                <button type="reset">ãƒªã‚»ãƒƒãƒˆ</button>
            </div>
        </form>

        <table>
            <tr><th>é …ç›®</th><th>å€¤</th></tr>
            <tr><td>ãƒ¡ãƒ«ã‚«ãƒªè²©å£²ä¾¡æ ¼</td><td id="displaySellingPrice">-</td></tr>
            <tr><td>ãƒ¡ãƒ«ã‚«ãƒªæ‰‹æ•°æ–™</td><td id="displayCommission">-</td></tr>
            <tr><td>ãƒ¡ãƒ«ã‚«ãƒªé€æ–™</td><td id="displayShippingCost">-</td></tr>
            <tr><td>ä»•å…¥ã‚Œå€¤ (å††)</td><td id="displayCostPriceJPY">-</td></tr>
            <tr><td>ä»•å…¥ã‚Œå€¤ (ã‚¦ã‚©ãƒ³)</td><td id="displayCostPriceKRW">-</td></tr>
            <tr><td>ä»•å…¥ã‚Œæ™‚é€æ–™</td><td id="displayPurchaseShippingCost">-</td></tr>
            <tr><td>é–¢ç¨</td><td id="displayCustomsDuty">-</td></tr>
            <tr><td>åˆ©ç›Š (å††)</td><td id="displayProfit" class="highlight">-</td></tr>
            <tr><td>åˆ©ç›Šç‡ (%)</td><td id="displayProfitRate">-</td></tr>
        </table>

        <div id="resultText" class="result-text"></div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const shippingCostSelect = document.getElementById('shippingCost');
            const shippingCostHandInput = document.getElementById('shippingCostHand');

            // åˆæœŸçŠ¶æ…‹ã§ã¯éè¡¨ç¤º
            shippingCostHandInput.style.display = 'none';

            // é€æ–™é¸æŠæ™‚ã®å‹•ä½œ
            shippingCostSelect.addEventListener('change', function () {
                if (shippingCostSelect.value === "None") {
                    shippingCostHandInput.style.display = 'block'; // è¡¨ç¤º
                    shippingCostHandInput.required = true; // å¿…é ˆã«è¨­å®š
                } else {
                    shippingCostHandInput.style.display = 'none'; // éè¡¨ç¤º
                    shippingCostHandInput.required = false; // å¿…é ˆã‚’è§£é™¤
                    shippingCostHandInput.value = ""; // å…¥åŠ›å€¤ã‚’ãƒªã‚»ãƒƒãƒˆ
                }
            });
        });

        async function fetchExchangeRate() {
            const response = await fetch('https://api.exchangerate-api.com/v4/latest/KRW');
            const data = await response.json();
            return data.rates.JPY;
        }

        async function calculateProfit() {
            const exchangeRate = await fetchExchangeRate();
            const sellingPrice = parseFloat(document.getElementById('sellingPrice').value) || 0;
            const commissionRate = parseFloat(document.getElementById('commissionRate').value) || 0;

            let shippingCost = parseFloat(document.getElementById('shippingCost').value) || 0;
            const shippingCostHand = parseFloat(document.getElementById('shippingCostHand').value) || 0;

            // "æ‰‹å…¥åŠ›ã™ã‚‹" ãŒé¸æŠã•ã‚Œã¦ã„ã‚‹å ´åˆã€shippingCost ã‚’ shippingCostHand ã®å€¤ã«å¤‰æ›´
            if (document.getElementById('shippingCost').value === "None") {
                shippingCost = shippingCostHand;
            }

            const costPrice = parseFloat(document.getElementById('costPrice').value) || 0;
            const purchaseShippingCost = parseFloat(document.getElementById('purchaseShippingCost').value) || 0;

            // é€šè²¨é¸æŠ
            const costPriceCurrency = document.querySelector('input[name="costPriceCurrency"]:checked').value;
            const costPriceInJPY = costPriceCurrency === "JPY"
                ? costPrice
                : costPrice * exchangeRate;

            const shippingCostCurrency = document.querySelector('input[name="shippingCostCurrency"]:checked').value;
            const purchaseShippingCostInJPY = shippingCostCurrency === "JPY"
                ? purchaseShippingCost
                : purchaseShippingCost * exchangeRate;

            // é–¢ç¨æœ‰ç„¡ã®é¸æŠ
            const customsDuty = document.querySelector('input[name="customsDuty"]:checked').value;
            const customsDutyPrice = customsDuty === "True"
                ? costPriceInJPY * 0.15
                : 0;

            const commission = sellingPrice * (commissionRate / 100);
            const profit = sellingPrice - commission - shippingCost - costPriceInJPY - purchaseShippingCostInJPY - customsDutyPrice;
            const profitRate = (profit / sellingPrice) * 100;

            document.getElementById('displaySellingPrice').textContent = sellingPrice.toFixed(0);
            document.getElementById('displayShippingCost').textContent = shippingCost.toFixed(0);
            document.getElementById('displayCustomsDuty').textContent = customsDutyPrice.toFixed(0);
            document.getElementById('displayCommission').textContent = commission.toFixed(0);
            document.getElementById('displayCostPriceJPY').textContent = costPriceInJPY.toFixed(0);
            document.getElementById('displayCostPriceKRW').textContent = (costPriceInJPY / exchangeRate).toFixed(0);
            document.getElementById('displayPurchaseShippingCost').textContent = purchaseShippingCostInJPY.toFixed(0);
            document.getElementById('displayProfit').textContent = profit.toFixed(0);
            document.getElementById('displayProfitRate').textContent = profitRate.toFixed(2);

            // çµæœã‚’resultTextã«è¡¨ç¤º
            const resultText = `ãƒ¡ãƒ«ã‚«ãƒªè²©å£²ä¾¡æ ¼ï¼š${sellingPrice.toFixed(0)}å††
ãƒ¡ãƒ«ã‚«ãƒªæ‰‹æ•°æ–™ï¼š${commission.toFixed(0)}å††
ãƒ¡ãƒ«ã‚«ãƒªé€æ–™ï¼š${shippingCost.toFixed(0)}å††
ä»•å…¥ã‚Œå€¤ï¼š${costPriceInJPY.toFixed(0)}å††
ä»•å…¥ã‚Œæ™‚é€æ–™ï¼š${purchaseShippingCostInJPY.toFixed(0)}å††
é–¢ç¨ï¼š${customsDutyPrice.toFixed(0)}å††
ï¼åˆ©ç›Šé¡ï¼š${profit.toFixed(0)}å††
`;
            document.getElementById('resultText').textContent = resultText;
        }
    </script>
</body>
</html>